apiApp.controller("ApiController",["$scope","$http","$location",function ApiController(a,c,b){a.settings=null;a.loaded=false;a.groups={ungrouped:[]};a.page="overview";a.groupNames=[];a.loadApiSettings=function(){c.get("/api/docs/settings",{}).success(function(f,d,g,e){a.settings=f;a.loadAllMethods()}).error(function(f,d,g,e){alert("Could not load API Documentation")})};a.loadAllMethods=function(){a.groups={ungrouped:[]};c.get("/api/docs",{}).success(function(h,d,j,e){a.allMethods=h;for(var g=0;g<a.allMethods.length;g++){var k=a.allMethods[g];if(k.options&&k.options.grouping){if(!a.groups[k.options.grouping]){a.groups[k.options.grouping]=[]}a.groups[k.options.grouping].push(k)}else{a.groups.ungrouped.push(k)}}for(var f in a.groups){a.groupNames.push(f)}a.groupNames.sort();a.loaded=true;a.selectPage()}).error(function(f,d,g,e){alert("Could not load API Settings")})};a.loadApiSettings();a.showConsoleModal=function(d){a.consoleMethod=d;a.results=null;a.resultsError=null;a.resultsErrorCode=null;a.consoleParams={};$("#consoleModal").modal()};a.getParamValue=function(d){if(d.type=="Object"){return JSON.parse($("#param_"+d.name).val())}else{return $("#param_"+d.name).val()}};a.runConsoleMethod=function(){a.results=null;a.resultsError=null;a.resultsErrorCode=null;var d=a.consoleMethod.url;if(a.consoleMethod.params&&a.consoleMethod.params.length>0){var e=[];for(var g=0;g<a.consoleMethod.params.length;g++){if(a.consoleMethod.params[g].index!=undefined){e.push(a.consoleMethod.params[g].name)}}if(e.length>0){e.sort().reverse();for(var g=0;g<e.length;g++){d=d.replace(":"+e[g],$("#param_"+e[g]).val())}}}var h="";var f={};if(a.consoleMethod.method=="GET"&&a.consoleMethod.params){for(var g=0;g<a.consoleMethod.params.length;g++){if(a.consoleMethod.params[g].index==undefined){if(h.length>0){h=h+"&"}else{h=h+"?"}h=h+a.consoleMethod.params[g].name+"="+$("#param_"+a.consoleMethod.params[g].name).val()}}for(var g=0;g<a.settings.authAttributes.length;g++){if(h.length>0){h=h+"&"}else{h=h+"?"}h=h+a.settings.authAttributes[g].name+"="+$("#auth_"+a.settings.authAttributes[g].name).val()}}else{for(var g=0;g<a.consoleMethod.params.length;g++){if(a.consoleMethod.params[g].index==undefined){f[a.consoleMethod.params[g].name]=a.getParamValue(a.consoleMethod.params[g])}}for(var g=0;g<a.settings.authAttributes.length;g++){f[a.settings.authAttributes[g].name]=$("#auth_"+a.settings.authAttributes[g].name).val()}}c({method:a.consoleMethod.method,url:d+h,data:f}).success(function(k,i,l,j){a.results=JSON.stringify(k,undefined,4)}).error(function(k,i,l,j){a.resultsError=k;a.resultsErrorCode=i})};a.selectPage=function(){a.selectedPage=a.groups[a.page]};a.$watch(function(){return b.path()},function(){a.page=getTabPage(b.path(),"overview");a.selectPage()})}]);